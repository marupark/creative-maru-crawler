name: MAILNARA v7.2 - API ê¸°ë°˜ ì§€ì›ì‚¬ì—… ìˆ˜ì§‘

on:
  schedule:
    - cron: '0 0 * * *'  # ë§¤ì¼ ì˜¤ì „ 9ì‹œ (KST ê¸°ì¤€)
  workflow_dispatch:

jobs:
  collect-and-send:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¦ ì½”ë“œ ì²´í¬ì•„ì›ƒ
      uses: actions/checkout@v4
    
    - name: ğŸ”§ Node.js ì„¤ì •
      uses: actions/setup-node@v4
      with:
        node-version: '18'
    
    - name: ğŸ“‹ ì˜ì¡´ì„± ì„¤ì¹˜
      run: npm install

    - name: ğŸ•’ ì‹œê°„ í™•ì¸ (KST ê¸°ì¤€)
      run: |
        echo "ğŸŒ í˜„ì¬ ì‹œê°„ (UTC): $(date)"
        echo "ğŸ‡°ğŸ‡· í•œêµ­ ì‹œê°„: $(TZ='Asia/Seoul' date)"
    
    - name: ğŸš€ MAILNARA v7.2 ì‹¤í–‰
      env:
        BIZINFO_API_KEY: ${{ secrets.BIZINFO_API_KEY }}
        EMAIL_USER: ${{ secrets.EMAIL_USER }}
        EMAIL_PASS: ${{ secrets.EMAIL_PASS }}
      run: |
        echo "ğŸ¯ MAILNARA v7.2 ì‹œì‘"
        echo "ğŸ“‹ íƒ€ê²Ÿ ê¸°ê´€: ê²½ìƒë‚¨ë„, ì‚°ì—…ë¶€, ì¤‘ê¸°ë¶€, íŠ¹í—ˆì²­"
        echo "ğŸ”‘ API í‚¤ ì• 10ì: ${BIZINFO_API_KEY:0:10}***"
        echo ""
        
        node index.js

    - name: ğŸ“Š ê²°ê³¼ ìš”ì•½
      if: always()
      run: |
        echo "âœ… MAILNARA v7.2 ì™„ë£Œ"
        echo "ğŸ“ˆ ê°œì„ ì‚¬í•­: API êµ¬ì¡° ëŒ€ì‘, í•„ë“œ ìºì‹œ ì°¨ë‹¨, ì ìˆ˜ ì •í™•í™”"
